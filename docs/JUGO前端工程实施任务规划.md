# JUGO前端工程实施任务规划

## 项目概述

基于web-prototype原型实现和backend后端工程，制定JUGO AI小说剧本创作平台的生产级前端工程实施计划。

### 当前状态分析

#### 1. Web-Prototype（原型）
- **技术栈**: React 18.2 + Ant Design + Vite
- **状态管理**: Zustand
- **路由**: React Router v6
- **富文本编辑器**: React Quill
- **已实现页面**:
  - 登录页 (Login)
  - 作品管理页 (Works)
  - 小说编辑器 (NovelEditor)
  - 剧本编辑器 (ScreenplayEditor)
  - 教程页 (Tutorial)
  - 个人中心 (Profile)
  - 关于我们 (About)

#### 2. Backend（后端）
- **技术栈**: Go + Gin + GORM
- **数据库**: MySQL 8.0+ + Redis 7+
- **消息队列**: RabbitMQ
- **对象存储**: MinIO/S3
- **AI服务**: Claude API + DeepSeek API
- **API风格**: RESTful + WebSocket
- **认证**: JWT Bearer Token
- **当前状态**: 阶段1完成（基础设施），待实现业务功能

#### 3. 设计文档
- **推荐技术栈**: Vue3 + Element Plus + TinyMCE
- **设计理念**: 轻量操作，重度赋能
- **核心目标**: 双场景适配、长文本友好、AI全流程赋能
- **响应式**: PC/平板/手机三端适配

## 技术选型决策

### 方案对比

| 维度 | 方案A: Vue3 + Element Plus | 方案B: React + Ant Design |
|------|---------------------------|--------------------------|
| 设计文档推荐 | ✅ 完全符合 | ❌ 不符合 |
| 原型代码复用 | ❌ 需要重写 | ✅ 可直接迁移 |
| 开发效率 | 中等（从零开始） | 高（基于原型） |
| 学习曲线 | 平缓 | 平缓 |
| 生态成熟度 | 成熟 | 非常成熟 |
| 组件库质量 | Element Plus（优秀） | Ant Design（优秀） |
| 富文本编辑器 | TinyMCE（推荐） | React Quill（已用） |
| 长文本性能 | 优秀 | 优秀 |
| 团队熟悉度 | 待评估 | 已有原型经验 |

### 推荐方案: React + Ant Design（方案B）

**理由**:
1. **快速迭代**: 可直接基于web-prototype进行生产化改造，节省50%+开发时间
2. **代码复用**: 页面结构、组件逻辑、状态管理可直接迁移
3. **技术成熟**: React + Ant Design生态完善，社区活跃
4. **渐进升级**: 可逐步替换React Quill为TinyMCE，优化长文本性能
5. **降低风险**: 避免从零开始带来的不确定性

## 前端工程架构设计

### 目录结构

```
frontend/
├── public/                    # 静态资源
│   ├── favicon.ico
│   └── logo.png
├── src/
│   ├── api/                   # API接口层
│   │   ├── auth.ts           # 认证相关API
│   │   ├── works.ts          # 作品管理API
│   │   ├── chapters.ts       # 章节管理API
│   │   ├── ai.ts             # AI功能API
│   │   ├── characters.ts     # 角色管理API
│   │   ├── export.ts         # 导出功能API
│   │   └── websocket.ts      # WebSocket连接
│   ├── assets/                # 资源文件
│   │   ├── images/
│   │   ├── fonts/
│   │   └── styles/
│   ├── components/            # 通用组件
│   │   ├── Layout/           # 布局组件
│   │   │   ├── MainLayout.tsx
│   │   │   ├── Sidebar.tsx
│   │   │   ├── Header.tsx
│   │   │   └── Footer.tsx
│   │   ├── Editor/           # 编辑器组件
│   │   │   ├── RichTextEditor.tsx
│   │   │   ├── MarkdownEditor.tsx
│   │   │   └── ScreenplayEditor.tsx
│   │   ├── AI/               # AI功能组件
│   │   │   ├── AIToolbar.tsx
│   │   │   ├── AIProgress.tsx
│   │   │   └── AIResultModal.tsx
│   │   └── Common/           # 通用UI组件
│   │       ├── Loading.tsx
│   │       ├── ErrorBoundary.tsx
│   │       └── ConfirmModal.tsx
│   ├── pages/                 # 页面组件
│   │   ├── Auth/
│   │   │   ├── Login.tsx
│   │   │   └── Register.tsx
│   │   ├── Works/
│   │   │   ├── WorksList.tsx
│   │   │   └── WorksDetail.tsx
│   │   ├── Editor/
│   │   │   ├── NovelEditor.tsx
│   │   │   └── ScreenplayEditor.tsx
│   │   ├── Tutorial/
│   │   │   └── Tutorial.tsx
│   │   ├── Profile/
│   │   │   └── Profile.tsx
│   │   └── About/
│   │       └── About.tsx
│   ├── hooks/                 # 自定义Hooks
│   │   ├── useAuth.ts
│   │   ├── useWebSocket.ts
│   │   ├── useAutoSave.ts
│   │   └── useAI.ts
│   ├── store/                 # 状态管理
│   │   ├── authStore.ts
│   │   ├── worksStore.ts
│   │   ├── editorStore.ts
│   │   └── uiStore.ts
│   ├── types/                 # TypeScript类型定义
│   │   ├── api.ts
│   │   ├── work.ts
│   │   ├── chapter.ts
│   │   └── user.ts
│   ├── utils/                 # 工具函数
│   │   ├── request.ts        # HTTP请求封装
│   │   ├── storage.ts        # 本地存储
│   │   ├── format.ts         # 格式化工具
│   │   └── validation.ts     # 表单验证
│   ├── config/                # 配置文件
│   │   ├── theme.ts          # 主题配置
│   │   ├── constants.ts      # 常量定义
│   │   └── env.ts            # 环境变量
│   ├── App.tsx                # 应用入口
│   ├── main.tsx               # 主文件
│   └── vite-env.d.ts
├── .env.development           # 开发环境变量
├── .env.production            # 生产环境变量
├── .eslintrc.js               # ESLint配置
├── .prettierrc                # Prettier配置
├── tsconfig.json              # TypeScript配置
├── vite.config.ts             # Vite配置
├── package.json
└── README.md
```

## 详细任务规划

### 阶段1: 项目初始化与基础设施（预计3-5天）

#### 1.1 项目脚手架搭建
- [ ] 创建Vite + React + TypeScript项目
- [ ] 配置ESLint + Prettier代码规范
- [ ] 配置Git Hooks（husky + lint-staged）
- [ ] 配置路径别名（@/）
- [ ] 配置环境变量管理

#### 1.2 依赖安装与配置
- [ ] 安装核心依赖
  - react, react-dom
  - react-router-dom (路由)
  - antd (UI组件库)
  - @ant-design/icons (图标)
  - zustand (状态管理)
  - axios (HTTP客户端)
  - dayjs (日期处理)
- [ ] 安装开发依赖
  - typescript
  - @types/react, @types/react-dom
  - @vitejs/plugin-react
  - sass (样式预处理器)
- [ ] 安装富文本编辑器
  - react-quill (初期使用)
  - @tinymce/tinymce-react (后期升级)
- [ ] 配置Ant Design主题定制

#### 1.3 基础配置文件
- [ ] 配置vite.config.ts（代理、别名、构建优化）
- [ ] 配置tsconfig.json（严格模式、路径映射）
- [ ] 创建.env文件（API_BASE_URL、WS_URL等）
- [ ] 配置主题色彩系统（theme.ts）
- [ ] 配置全局常量（constants.ts）

#### 1.4 工具函数封装
- [ ] HTTP请求封装（axios拦截器、错误处理、token管理）
- [ ] WebSocket连接封装（自动重连、心跳检测）
- [ ] 本地存储封装（localStorage、sessionStorage）
- [ ] 日期格式化工具
- [ ] 文件大小格式化工具
- [ ] 表单验证工具

### 阶段2: 认证与用户模块（预计2-3天）

#### 2.1 认证功能
- [ ] 登录页面开发
  - 表单设计（邮箱、密码）
  - 表单验证
  - 登录API对接
  - Token存储
  - 错误提示
- [ ] 注册页面开发
  - 表单设计（邮箱、用户名、密码）
  - 密码强度校验
  - 注册API对接
- [ ] 认证状态管理（authStore）
  - 登录状态
  - 用户信息
  - Token刷新逻辑
  - 登出功能
- [ ] 路由守卫
  - ProtectedRoute组件
  - 未登录重定向
  - Token过期处理

#### 2.2 用户中心
- [ ] 个人信息展示
  - 头像、用户名、邮箱
  - 创作统计（作品数、总字数、章节数）
- [ ] 个人信息编辑
  - 修改用户名
  - 修改头像（上传功能）
  - 修改密码
- [ ] 账号设置
  - 创作偏好设置
  - 自动保存间隔设置
  - 默认编辑模式设置

### 阶段3: 作品管理模块（预计3-4天）

#### 3.1 作品列表页
- [ ] 页面布局设计
  - 顶部筛选栏（类型、状态、排序）
  - 搜索功能
  - 新建作品按钮
- [ ] 作品卡片组件
  - 封面图展示
  - 标题、类型、字数、章节数
  - 更新时间
  - 操作按钮（编辑、导出、删除）
- [ ] 作品列表API对接
  - 获取作品列表
  - 分页加载
  - 筛选和排序
  - 搜索功能
- [ ] 作品操作功能
  - 删除作品（二次确认）
  - 快速编辑入口
  - 作品状态切换

#### 3.2 创建作品功能
- [ ] 创建作品弹窗
  - 作品类型选择（小说/剧本）
  - 基本信息表单（标题、主题、题材）
  - 小说配置（章节数、每章字数）
  - 剧本配置（场景数、时长）
- [ ] 创建作品API对接
- [ ] 创建成功后跳转编辑器

#### 3.3 作品详情页
- [ ] 作品基本信息展示
- [ ] 章节/场景列表
- [ ] 角色列表
- [ ] 编辑入口

### 阶段4: 小说编辑器模块（预计5-7天）

#### 4.1 编辑器布局
- [ ] 三栏布局实现
  - 左侧设置区（240px固定宽度）
  - 中间编辑区（自适应）
  - 右侧预览区（可折叠）
- [ ] 响应式适配
  - PC端：三栏布局
  - 平板端：双栏布局（设置/预览可切换）
  - 手机端：单栏布局

#### 4.2 左侧设置区
- [ ] 作品基本信息
  - 标题编辑
  - 题材选择
  - 风格设置
  - 字数目标
- [ ] 章节管理
  - 章节列表
  - 新增章节
  - 删除章节
  - 章节排序
  - 章节导航
- [ ] AI设置
  - 续写长度
  - 风格偏好
  - 创意程度
- [ ] 辅助功能
  - 字数统计
  - 阅读时长估算
  - 夜间模式切换

#### 4.3 中间编辑区
- [ ] 富文本编辑器集成
  - React Quill配置
  - 自定义工具栏
  - 格式化功能（加粗、斜体、标题等）
  - 图片上传
- [ ] 编辑器优化
  - 长文本性能优化（虚拟滚动）
  - 自动保存（30秒间隔）
  - 撤销/重做
  - 快捷键支持（Ctrl+S保存、Ctrl+Z撤销）
- [ ] 章节内容编辑
  - 章节标题编辑
  - 章节内容编辑
  - 章节切换

#### 4.4 右侧预览区
- [ ] 实时预览
  - 内容实时同步
  - 格式化展示
  - 滚动同步
- [ ] 问题提示
  - 错别字检测
  - 语法问题提示
  - 重复内容提示
- [ ] 章节进度
  - 当前章节字数
  - 目标字数进度条
  - 完成度统计

#### 4.5 AI功能集成
- [ ] AI工具栏
  - 续写按钮
  - 润色按钮
  - 扩写按钮
  - 改写按钮
  - 大纲生成按钮
- [ ] AI功能实现
  - 选中文字快捷菜单
  - AI请求发送
  - 进度展示（进度条+百分比）
  - 结果展示（弹窗或内联）
  - 结果应用（接受/拒绝）
- [ ] AI任务管理
  - 任务状态轮询
  - WebSocket实时推送
  - 任务取消功能
  - 历史记录

#### 4.6 自动保存与同步
- [ ] 自动保存功能
  - 30秒间隔自动保存
  - 保存状态提示
  - 保存失败重试
- [ ] WebSocket实时同步
  - 连接建立
  - 心跳检测
  - 断线重连
  - 内容同步

### 阶段5: 剧本编辑器模块（预计4-5天）

#### 5.1 剧本编辑器布局
- [ ] 三栏布局（同小说编辑器）
- [ ] 剧本专用样式
  - 等宽字体（Courier New）
  - 行高调整（1.6）
  - 专业格式对齐

#### 5.2 剧本格式编辑
- [ ] 场景标题格式
  - 场景编号
  - 场景地点
  - 时间（白天/夜晚）
  - 内景/外景
- [ ] 角色台词格式
  - 角色名居中
  - 台词缩进
  - 括号注释（动作、表情）
- [ ] 场景描述格式
  - 场景描述
  - 动作描述
  - 音效描述
- [ ] 格式快捷键
  - 快速插入场景标题
  - 快速插入角色台词
  - 格式自动识别

#### 5.3 场景管理
- [ ] 场景列表
  - 场景卡片展示
  - 场景时长统计
  - 场景排序
- [ ] 场景操作
  - 新增场景
  - 删除场景
  - 场景复制
  - 场景移动

#### 5.4 角色管理
- [ ] 角色列表
  - 角色卡片
  - 角色出场次数统计
- [ ] 角色编辑
  - 角色名称
  - 角色描述
  - 角色特征
  - 角色关系
- [ ] 角色快速插入
  - 编辑器中快速选择角色
  - 角色台词自动格式化

#### 5.5 剧本AI功能
- [ ] 小说转剧本
  - 转换配置（场景数、时长）
  - 转换进度展示
  - 转换结果预览
  - 转换结果应用
- [ ] 剧本续写
  - 场景续写
  - 台词生成
- [ ] 剧本润色
  - 台词优化
  - 场景描述优化

### 阶段6: 导出功能模块（预计2-3天）

#### 6.1 导出配置
- [ ] 导出格式选择
  - DOCX（Word文档）
  - PDF
  - TXT（纯文本）
  - Markdown
- [ ] 导出选项
  - 选择章节/场景
  - 包含封面
  - 包含目录
  - 字体大小
  - 页边距

#### 6.2 导出功能实现
- [ ] 导出API对接
  - 创建导出任务
  - 任务状态轮询
  - 下载链接获取
- [ ] 导出进度展示
  - 进度条
  - 百分比
  - 预计剩余时间
- [ ] 文件下载
  - 自动下载
  - 下载失败重试
  - 下载历史记录

### 阶段7: 教程与帮助模块（预计1-2天）

#### 7.1 教程页面
- [ ] 新手引导
  - 创建第一个作品
  - 使用AI功能
  - 导出作品
- [ ] 功能教程
  - 小说创作教程
  - 剧本创作教程
  - 雪花写作法引导
- [ ] 视频教程嵌入
- [ ] 常见问题FAQ

#### 7.2 帮助中心
- [ ] 搜索功能
- [ ] 分类导航
- [ ] 文档展示
- [ ] 反馈入口

### 阶段8: 关于我们与其他页面（预计1天）

#### 8.1 关于我们页面
- [ ] 平台介绍
- [ ] 核心功能展示
- [ ] 团队介绍
- [ ] 联系方式

#### 8.2 404页面
- [ ] 404页面设计
- [ ] 返回首页按钮

### 阶段9: 性能优化与测试（预计3-5天）

#### 9.1 性能优化
- [ ] 代码分割（React.lazy + Suspense）
- [ ] 路由懒加载
- [ ] 组件懒加载
- [ ] 图片懒加载
- [ ] 长文本虚拟滚动
- [ ] 防抖节流优化
- [ ] 打包体积优化
  - Tree Shaking
  - 代码压缩
  - Gzip压缩
  - CDN加速

#### 9.2 用户体验优化
- [ ] 加载状态优化
  - 骨架屏
  - Loading动画
  - 进度提示
- [ ] 错误处理优化
  - 全局错误边界
  - 友好错误提示
  - 错误上报
- [ ] 交互优化
  - 操作反馈
  - 动画过渡
  - 快捷键支持

#### 9.3 兼容性测试
- [ ] 浏览器兼容性测试
  - Chrome（最新版）
  - Edge（最新版）
  - Firefox（最新版）
  - Safari（最新版）
- [ ] 响应式测试
  - PC端（≥1200px）
  - 平板端（768px-1199px）
  - 手机端（≤767px）
- [ ] 功能测试
  - 登录注册流程
  - 作品CRUD操作
  - 编辑器功能
  - AI功能
  - 导出功能
  - WebSocket连接

#### 9.4 安全性测试
- [ ] XSS防护测试
- [ ] CSRF防护测试
- [ ] Token安全测试
- [ ] 敏感信息保护

### 阶段10: 部署与上线（预计1-2天）

#### 10.1 构建配置
- [ ] 生产环境配置
- [ ] 环境变量配置
- [ ] 构建脚本优化
- [ ] 静态资源CDN配置

#### 10.2 部署
- [ ] 选择部署方案
  - Vercel（推荐，零配置）
  - Netlify
  - 自建服务器（Nginx）
- [ ] CI/CD配置
  - GitHub Actions
  - 自动构建
  - 自动部署
- [ ] 域名配置
- [ ] HTTPS配置

#### 10.3 监控与日志
- [ ] 错误监控（Sentry）
- [ ] 性能监控（Google Analytics）
- [ ] 用户行为分析
- [ ] 日志收集

## 技术难点与解决方案

### 1. 长文本编辑性能优化

**问题**: 10万+字长文本编辑卡顿

**解决方案**:
- 使用虚拟滚动（react-window或react-virtualized）
- 分章节加载，避免一次性加载全部内容
- 使用Web Worker处理文本分析
- 优化富文本编辑器配置，减少不必要的DOM操作
- 考虑后期升级到TinyMCE（性能更好）

### 2. 实时自动保存

**问题**: 频繁保存影响性能，网络波动导致保存失败

**解决方案**:
- 使用防抖（debounce）减少保存频率
- WebSocket优先，HTTP轮询兜底
- 本地缓存机制，离线编辑支持
- 保存失败自动重试（指数退避）
- 版本冲突检测与合并

### 3. AI功能实时反馈

**问题**: AI生成耗时长，用户体验差

**解决方案**:
- WebSocket实时推送进度
- 流式输出（SSE或WebSocket）
- 进度条+百分比+预计时间
- 支持任务取消
- 后台任务队列，支持多任务并行

### 4. 小说剧本双格式切换

**问题**: 格式转换复杂，内容丢失风险

**解决方案**:
- 统一数据结构，格式仅影响展示层
- 转换前二次确认+提示
- 转换后保留原格式副本
- AI辅助转换，提高准确性
- 转换结果预览，用户确认后应用

### 5. 多端响应式适配

**问题**: PC/平板/手机三端体验差异大

**解决方案**:
- 使用Ant Design响应式栅格系统
- CSS媒体查询精细控制
- 移动端简化功能，保留核心操作
- 触摸手势支持（平板/手机）
- 渐进式Web应用（PWA）支持离线使用

## 开发规范

### 1. 代码规范
- 使用ESLint + Prettier统一代码风格
- 使用TypeScript严格模式
- 组件命名：PascalCase
- 文件命名：PascalCase（组件）、camelCase（工具函数）
- 变量命名：camelCase
- 常量命名：UPPER_SNAKE_CASE

### 2. Git规范
- 分支命名：feature/xxx、bugfix/xxx、hotfix/xxx
- Commit规范：
  - feat: 新功能
  - fix: 修复bug
  - docs: 文档更新
  - style: 代码格式调整
  - refactor: 重构
  - perf: 性能优化
  - test: 测试
  - chore: 构建/工具链

### 3. 组件开发规范
- 单一职责原则
- 组件拆分粒度适中
- Props类型定义完整
- 必要的注释和文档
- 错误边界处理

### 4. API调用规范
- 统一使用封装的request函数
- 错误统一处理
- Loading状态统一管理
- 请求取消支持（避免内存泄漏）

## 时间估算

| 阶段 | 任务 | 预计时间 |
|------|------|---------|
| 阶段1 | 项目初始化与基础设施 | 3-5天 |
| 阶段2 | 认证与用户模块 | 2-3天 |
| 阶段3 | 作品管理模块 | 3-4天 |
| 阶段4 | 小说编辑器模块 | 5-7天 |
| 阶段5 | 剧本编辑器模块 | 4-5天 |
| 阶段6 | 导出功能模块 | 2-3天 |
| 阶段7 | 教程与帮助模块 | 1-2天 |
| 阶段8 | 关于我们与其他页面 | 1天 |
| 阶段9 | 性能优化与测试 | 3-5天 |
| 阶段10 | 部署与上线 | 1-2天 |
| **总计** | | **25-37天** |

**说明**:
- 以上时间为单人全职开发估算
- 实际时间可能因需求变更、技术难点等因素有所调整
- 建议预留20%的缓冲时间

## 人员配置建议

### 最小团队配置（2人）
- **前端开发工程师 x 1**: 负责所有前端开发工作
- **UI/UX设计师 x 1**: 负责视觉设计、交互设计、原型优化

### 理想团队配置（3-4人）
- **前端开发工程师 x 2**: 分工负责不同模块
- **UI/UX设计师 x 1**: 负责设计工作
- **测试工程师 x 1**: 负责功能测试、性能测试、兼容性测试

## 风险评估与应对

### 1. 技术风险
- **风险**: 长文本编辑器性能不达标
- **应对**: 提前进行性能测试，必要时更换编辑器方案

### 2. 进度风险
- **风险**: 开发进度延期
- **应对**: 采用敏捷开发，分阶段交付，优先实现核心功能

### 3. 需求风险
- **风险**: 需求变更频繁
- **应对**: 需求评审机制，变更影响评估，版本迭代管理

### 4. 质量风险
- **风险**: 测试不充分，上线后bug多
- **应对**: 单元测试、集成测试、E2E测试，灰度发布

## 后续迭代计划

### V1.1 版本（上线后1-2个月）
- [ ] 升级富文本编辑器为TinyMCE
- [ ] 增强AI功能（更多AI工具）
- [ ] 优化移动端体验
- [ ] 增加协作功能（多人编辑）

### V1.2 版本（上线后3-4个月）
- [ ] 版本历史管理
- [ ] 作品模板库
- [ ] 素材库功能
- [ ] 社区功能（作品分享、评论）

### V2.0 版本（上线后6个月）
- [ ] 桌面客户端（Electron）
- [ ] 移动端App（React Native）
- [ ] 离线编辑增强
- [ ] 云端同步优化

## 总结

本任务规划基于web-prototype原型和backend后端实现，采用React + Ant Design技术栈，分10个阶段完成JUGO前端工程的生产化开发。核心特点：

1. **快速迭代**: 基于原型代码，节省开发时间
2. **技术成熟**: React生态完善，降低技术风险
3. **分阶段交付**: 敏捷开发，快速验证
4. **性能优先**: 长文本优化，AI实时反馈
5. **用户体验**: 响应式设计，多端适配

预计开发周期25-37天（单人全职），建议配置2-4人团队，采用敏捷开发模式，分阶段交付，确保项目按时高质量完成。
